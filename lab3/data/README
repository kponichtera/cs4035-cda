########################################################
Malware Capture Facility
CVUT University, Prague, Czech Republic

These files were generated as part of a research project in the CVUT University, Prague, Czech Republic.
The goal is to store long-lived real botnet traffic and to generate labeled netflows files.
Any question feel free to contact us:
Sebastian Garcia: sebastian.garcia@agents.fel.cvut.cz

Disclaimer: You are free to use these files as long as you reference this project and the authors.
########################################################


Pcap files:
- capture20110818.pcap
It is a capture with all the traffic (background, normal and botnet)
This pcap file is not made public because it contains too much private information about the users of the network.

- botnet-capture-20110818-bot.pcap
Capture with only the botnet traffic. It is made public.

Netflow files:
- capture20110818.pcap.netflow.labeled
This file has the netflows generated by a unidirectional argus. The labels were assigned as this:
1- First put Background to all the flows.
2- Put LEGITIMATE to the flows that match some filters.
3- Put Botnet to the flows that come to or from the IP address 147.32.84.165

The filters for normal (or legitimate) traffic had the IP address of our co-workers in the lab that we are sure were not infected because we check their computers by hand.


Generic info
------------
Binary used: rbot.exe
Md5: 2467b3c8b259cecd6ce2d5c31009df10
Probable Name: rbot

Infected Machines:
Windows XP Name: SARUMAN,  IP: 147.32.84.165 (Label: Botnet)
Windows XP Name: SARUMAN1, IP: 147.32.84.191 (Label: Botnet)
Windows XP Name: SARUMAN2, IP: 147.32.84.192 (Label: Botnet)
Windows XP Name: SARUMAN3, IP: 147.32.84.193 (Label: Botnet)
Windows XP Name: SARUMAN4, IP: 147.32.84.204 (Label: Botnet)
Windows XP Name: SARUMAN5, IP: 147.32.84.205 (Label: Botnet)
Windows XP Name: SARUMAN6, IP: 147.32.84.206 (Label: Botnet)
Windows XP Name: SARUMAN7, IP: 147.32.84.207 (Label: Botnet)
Windows XP Name: SARUMAN8, IP: 147.32.84.208 (Label: Botnet)
Windows XP Name: SARUMAN9, IP: 147.32.84.209 (Label: Botnet)


Timeline
========
jue ago 18 10:19:02 CEST 2011
We started the overall capture.
Bandwith is limited to 10000kbps on every vm.

jue ago 18 10:46:34 CEST 2011
We started the bot capture.

Starting vms
------------
jue ago 18 10:46:53 CEST 2011
We started saruman

jue ago 18 10:47:55 CEST 2011
We started saruman1

jue ago 18 10:54:20 CEST 2011
We started saruman2

jue ago 18 10:55:18 CEST 2011
We started saruman3

jue ago 18 10:56:13 CEST 2011
We started saruman4

jue ago 18 10:57:10 CEST 2011
We started saruman5

jue ago 18 10:58:49 CEST 2011
We started saruman6

jue ago 18 10:59:39 CEST 2011
We started saruman7

jue ago 18 11:00:10 CEST 2011
We started saruman8

jue ago 18 11:00:20 CEST 2011
We started saruman9


jue ago 18 11:00:43 CEST 2011
I connected to the C&C irc channel from my non-public IP.


INFECTION
jue ago 18 11:03:05 CEST 2011
We infected saruman9

jue ago 18 11:03:52 CEST 2011
We infected saruman8

jue ago 18 11:04:20 CEST 2011
We infected saruman7

jue ago 18 11:04:46 CEST 2011
We infected saruman6

jue ago 18 11:05:13 CEST 2011
We infected saruman4

jue ago 18 11:05:41 CEST 2011
We infected saruman2

jue ago 18 11:06:10 CEST 2011
We infected saruman

jue ago 18 11:06:32 CEST 2011
We infected saruman1

jue ago 18 11:06:52 CEST 2011
We infected saruman3

jue ago 18 11:07:15 CEST 2011
We infected saruman5


jue ago 18 11:07:35 CEST 2011
We login and get some info.
	.login zarasa48
	.sysinfo
	.netinfo


jue ago 18 11:52:54 CEST 2011
We started the UDP attack agains 147.32.96.69
	.udpflood 147.32.96.69 100000 1500 10 161

jue ago 18 12:07:30 CEST 2011
We stopped the udp flood. Because we were getting too much fragmented packets.
	.udpstop

jue ago 18 12:08:43 CEST 2011
We started the UDP flood again using only 1000 bytes per packet.
        .udpflood 147.32.96.69 100000 1000 10 161

jue ago 18 12:11:04 CEST 2011
We changed the bandwith to 100000kbps.


jue ago 18 12:11:54 CEST 2011
We stopped the attack.


jue ago 18 12:12:20 CEST 2011
We started the UDP flood again using only 1000 bytes per packet.
        .udpflood 147.32.96.69 100000 1000 10 161


jue ago 18 12:13:32 CEST 2011
We erase the bandwith limit. But not change in the amount of packets was seen.


jue ago 18 12:14:53 CEST 2011
We stopped the attack.


jue ago 18 12:16:44 CEST 2011
We tried .synflood, ddos.syn and ddos.ack but they did not worked.

jue ago 18 12:18:15 CEST 2011
We used .icmpflood 147.32.96.69 1000

jue ago 18 12:18:45 CEST 2011
We put the bandwith again in 100000kpbs

jue ago 18 11:31:31 CEST 2011
We stopped the icmp flood. It was successfull! I can not ping the victim nor connect with ssh.


jue ago 18 12:33:26 CEST 2011
We start to stop all the vms.

jue ago 18 12:36:02 CEST 2011
We end stopping the vms.

---- 1 hour later... ----

jue ago 18 13:46:31 CEST 2011
We start to start the vms again.
Bandwith is still in 100000kpbs
The vms are already infected with the rbot


jue ago 18 13:52:51 CEST 2011
We end starting the vms.


jue ago 18 13:53:35 CEST 2011
We login in the vms using IRC.
	.login zarasa48

jue ago 18 13:56:52 CEST 2011
We started the UDP flood attack again.


jue ago 18 14:05:48 CEST 2011
We changed the bandwith to 1000000kpbs


jue ago 18 14:06:12 CEST 2011
We started the UDP flood attack again.


jue ago 18 14:07:25 CEST 2011
We stopped the attack because it seems not to be using the whole bandwith

jue ago 18 14:09:04 CEST 2011
We started the UDP flood attack again.

jue ago 18 14:09:29 CEST 2011
We stopped the attack because it seems not to be using the whole bandwith


jue ago 18 14:10:08 CEST 2011
We started the UDP flood attack again.

jue ago 18 14:10:43 CEST 2011
We stopped the attack because it seems not to be using the whole bandwith

jue ago 18 14:14:31 CEST 2011
We changed the bandwith to 10000000kpbs


jue ago 18 14:14:47 CEST 2011
We started the UDP flood attack again.

jue ago 18 14:15:59 CEST 2011
We stopped the attack because it seems not to be using the whole bandwith


jue ago 18 14:29:28 CEST 2011
We changed the burst to 100kb and keep the bandwith in 10000000kpbs


jue ago 18 14:30:02 CEST 2011
We started the UDP flood attack again.


jue ago 18 14:30:38 CEST 2011
We stopped the attack because it seems not to be using the whole bandwith


jue ago 18 14:39:52 CEST 2011
We changed the burst to 100kb and the bandwith to 100000000kpbs

jue ago 18 14:41:27 CEST 2011
We started the UDP flood attack again.


jue ago 18 14:42:07 CEST 2011
We stopped the attack because it seems not to be using the whole bandwith


jue ago 18 14:42:58 CEST 2011
We changed the burst to 100kb and the bandwith to 1000000kpbs


jue ago 18 14:43:27 CEST 2011
We started the ICMP flood attack again.


jue ago 18 14:44:04 CEST 2011
We stopped the attack because was using to much bandwith i think. I can not ping the victim.
I'm not sure that the attack really stopped...


jue ago 18 14:46:00 CEST 2011
We start to power off the vms.


jue ago 18 14:53:04 CEST 2011
We ended to power off the vms.


jue ago 18 14:56:55 CEST 2011
We start the vms again.

jue ago 18 14:58:53 CEST 2011
We end starting the vms again.

jue ago 18 14:59:35 CEST 2011
We changed the burst to 100kb and the bandwith to 10000kpbs


jue ago 18 15:00:17 CEST 2011
We login into the vms.


jue ago 18 15:00:46 CEST 2011
We started the ICMP flood attack again. The attack is working but i can ping the victim without problem.

jue ago 18 15:03:42 CEST 2011
We stopped the attack by the IRC.


jue ago 18 15:04:31 CEST 2011
We start to power off the vms.


jue ago 18 15:07:29 CEST 2011
We ended to power off the vms.


jue ago 18 15:07:59 CEST 2011
We changed the burst to 100kb and the bandwith to 100000kpbs


jue ago 18 15:12:50 CEST 2011
We start to start the vms.

jue ago 18 15:14:54 CEST 2011
We ended starting the vms.


jue ago 18 15:15:25 CEST 2011
We login into the vms.

jue ago 18 15:16:38 CEST 2011
We started saruman7 with the ICMP flood attack. 1000 seconds

jue ago 18 15:17:52 CEST 2011
We started saruman1 with the ICMP flood attack. 300 seconds only

jue ago 18 15:19:00 CEST 2011
We started saruman2 with the ICMP flood attack. 300 seconds only

I think here the attack was successful. No ping any more.

jue ago 18 15:20:10 CEST 2011
We started saruman5 with the ICMP flood attack. 300 seconds only

jue ago 18 15:21:14 CEST 2011
We started saruman with the ICMP flood attack. 300 seconds only

jue ago 18 15:21:57 CEST 2011
We started saruman4 with the ICMP flood attack. 300 seconds only


jue ago 18 15:25:51 CEST 2011
I manually restarted saruman7 because was going to continue sending packets.
The rest of the bots stopped after 300 seconds.



jue ago 18 15:32:04 CEST 2011
We started saruman1 with the ICMP flood attack. 300 seconds only

jue ago 18 15:32:53 CEST 2011
We started saruman2 with the ICMP flood attack. 300 seconds only

jue ago 18 15:33:35 CEST 2011
We started saruman5 with the ICMP flood attack. 300 seconds only

At this point the attack was successful!!!!!!!! no ssh and no ping!!


jue ago 18 15:35:38 CEST 2011
The attack stopped by timeout.

jue ago 18 15:37:05 CEST 2011
We stopped all the vms


WARNING!!
I think that due to a disk space outrun in the computer, the overall capture file ended early. 
